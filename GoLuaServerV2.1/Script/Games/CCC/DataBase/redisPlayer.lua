---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2018/12/7 15:25
---




----------------------------玩家的数据-----------------------------
function RedisSavePlayer(User)
    RedisSaveString(RedisDirAllPlayers..User.UserID,User.UserID, ZJson.encode(User))
end

function RedisGetPlayer(uid)
    --return  ZJson.decode(RedisGetString(RedisDirAllPlayers..uid, uid))
    local json =  ZJson.decode(RedisGetString(RedisDirAllPlayers..uid, uid))
    local user = User:New(uid,"")

    --printTable(user)
    -- 下面做一个遍历， 这个遍历的好处是 ，如果游戏更新，增加了字段， 不需要维护， 因为玩家登录的时候， 没有的字段会默认为初始值 ，再保存，新字段就有了
    if json ~= nil then
        for k,v in pairs(user) do
            if json[k] ~= nil then
                user[k] = json[k]       -- 将数据库保存数据赋值
            end
            --if type(v) == "string" then
            --    print(k.."    " .. v)
            --else
            --    print(k .."    "..type(v))
            --end
        end
    end
    return  user
end

----------------------------玩家登录 open id -----------------------------
function RedisSavePlayerLogin(openId,Uid)
    RedisSaveString(RedisDirAllPlayersLogin..openId,openId, Uid)
end

function RedisGetPlayerLogin(openId)
    return  RedisGetString(RedisDirAllPlayersLogin..openId, openId)     -- 返回Uid
end

----------------------------玩家登录 聊天相关 -----------------------------
--- 保存玩家聊天相关信息
--- @param UserID 用户ID
--- @param ChatUser 用户聊天信息
function RedisSavePlayerChatInfo(UserID, ChatUser)
    RedisSaveString(RedisDirChatPlayers, UserID, ZJson.encode(ChatUser))
end

--- 获取用户聊天信息
function RedisGetPlayerChatInfo(UserID)
    local json =  ZJson.decode(RedisGetString(RedisDirChatPlayers, UserID))
    local chatUser = ChatUser:New()

    if json ~= nil then
        for k,v in pairs(chatUser) do
            if json[k] ~= nil then
                chatUser[k] = json[k]       -- 将数据库保存数据赋值
            end
        end
    end
    return  chatUser
end