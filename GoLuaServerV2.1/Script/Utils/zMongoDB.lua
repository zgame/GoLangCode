---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by zhushiwei.
--- DateTime: 2020/11/26 14:44
---


MyMongoEngine = require('mongodb')
MyMongoEngineConnect = MyMongoEngine.new()

-- Mongo数据库连接
function MyMongoConnect(h,d,u,ps)

    local ok, err = MyMongoEngineConnect:connect({ host = h, database = d, user = u, password = ps })

    if ok then
        print(" Mongo  数据库 ok!")
        --local res, err = MySqlEngineConnect:query("SELECT * FROM game_state")
        --if err then
        --    print(err)
        --else
        --    printTable(res)
        --end

        --
        --local user = {}
        --user["ss"] = 22
        --user["name"] = 'ss'
        --user["ss2"] = "223"
        --MongoInsert("people",user)


        local user2 = {}
        user2["name"] = 'ss'
        local ss = MongoFinds("people",user2,"key")
        --print(ss["ss"])
        printTable(ss)



    end

    return ok

end



-- 执行find语句
function MongoFind(collection, table)
    return   MyMongoEngineConnect:find(collection, table)
end

-- 执行finds语句  查询多条记录  sort里面是列名 负的表示从高到低排序
function MongoFinds(collection, table, sort)
    if sort == nil then
        sort = "-1"
    end
    return   MyMongoEngineConnect:finds(collection, table, sort)
end

-- 执行insert语句
function MongoInsert(collection, table)
    MyMongoEngineConnect:insert(collection, table)
end


-- 执行del语句
function MongoDel(collection, table)
    MyMongoEngineConnect:del(collection, table)
end


-- 执行update语句  selectTable为条件  updateTable为更新的内容
function MongoUpdate(collection, selectTable,updateTable)
    MyMongoEngineConnect:update(collection, selectTable, updateTable)
end

