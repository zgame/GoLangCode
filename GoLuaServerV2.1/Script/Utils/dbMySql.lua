---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2018/12/11 11:18
---

------------------------------------------------------------------------
--- 这是lua直接调用mysql， 特点是写的方便，多用于select查询数据，也可以用于其他语句的顺序执行过程
------------------------------------------------------------------------


MySqlEngine = require('mySql')
--MySqlMainEngineConnect = MySqlEngine.new()
--- 创建数据库句柄
function MySqlNew()
    return MySqlEngine.new()
end


-- mysql数据库连接
function MysqlConnect(handle,h,p,d,u,ps)
    local ok, err = handle:connect({ host = h, port = tonumber(p), database = d, user = u, password = ps })

    if ok then
        print("Mysql 数据库 ok!")
        --printTable(MysqlQuery("select * from game_state"))

    end

    return ok,err

end

-- 执行sql select语句
function MysqlQuery(sql,handle)
    if handle == nil then
        handle = MySqlMainEngineConnect
    end
    local re,err = handle:query(sql)
    if err ~= nil then
        Logger(err)
    end
    return re
end


-- 执行sql exec语句
function MysqlExec(sql,handle)
    if handle == nil then
        handle = MySqlMainEngineConnect
    end
    local err = handle:exec(sql)
    if err ~= nil then
        Logger(err)
    end
end

